<script type="text/javascript">
$(document).ready(function () {
    $('.alert-message').mouseover(function () {
        console.log(this.id);
    });
    
    $('.switch').click(function () {
        console.log("Switching vdr to channel: "+ $(this).attr('channel'));
        
        var channelname = $(this).attr('channelname');

        $.post('<%= switchUrl %>/' + $(this).attr('channel'), function () {
            $('#overlay').css({
                opacity: 0.5,
                width: $(document).width(),
                height: $(document).height()
            }).show();
            
            $('#channelinfo').html('VDR switched to channel '+ channelname);

            $('#dialog').css({
                top: (($(window).height() - $(this).outerHeight()) / 2) + $(window).scrollTop() + "px",
                left: (($(window).width() - $(this).outerWidth()) / 2) + $(window).scrollLeft() + "px"
            }).show();
        }).error(function () {
            $('#overlay').css({
                opacity: 0.5,
                width: $(document).width(),
                height: $(document).height()
            }).show();

            $('#errordialog').css({
                top: (($(window).height() - $(this).outerHeight()) / 2) + $(window).scrollTop() + "px",
                left: (($(window).width() - $(this).outerWidth()) / 2) + $(window).scrollLeft() + "px"
            }).show();
        });

        $('.btn_ok').click(function () {
            $('#overlay').hide();
            $('.modal').hide();
        });
    });
});
</script>
<div class="page-header">
    <h1>
        Timeline
        <small>The complete TV program always in your view</small>
    </h1>
</div>

<div class="row" style="overflow: hidden; margin-bottom: 0px;">
    <div class="span3 columns" style="white-space:nowrap; overflow: hidden;">
        <% if (channels) {
        for (i in channels) { 
        %>
        <h5 style="height: 56px;"><%= channels[i].channel.name %> <img class="switch" channelname="<%= channels[i].channel.name %>" channel="<%= channels[i].channel.channel_id %>" style="cursor: pointer;" src="/img/devine/black/TV.png" width="20px" height="20px" title="Switch to this channel" /></h5>
        <% }} %>
    </div>
    <div class="span13 columns scrollerMother" style="overflow: auto; white-space:nowrap; position: relative;">
        <% if (channels) {
        for (i in channels) { %>
        <div>
            <% if (channels[i].epg) {
            channels[i].epg.events.forEach(function (broadcast) { %>
            <div class="alert-message warning" id="<%= broadcast.id / 20 %>" title="<%= broadcast.title %>" style="cursor: pointer; width: <%= broadcast.duration / 20 %>px; position: realtive; display: inline-block; margin-left: 5px; overflow: hidden">
                <p>
                    <%= broadcast.title %>
                </p>
            </div>
            <% 
            })
        }} %>
        </div>
        <% } %>
    </div>
</div>

<div id="overlay" style="position: absolute; top: 0; left: 0; z-index: 101; display: none; color: #CCCCCC;">
    
</div>
<div id="dialog" class="modal" style="position: fixed; top: auto; left: auto; z-index: 101; display: none">
    <div class="modal-header">
        <h3>Switched</h3>
    </div>
    <div class="modal-body">
        <p id="channelinfo">VDR switched to channel </p>
    </div>
    <div class="modal-footer">
        <a class="btn_ok btn primary">OK</a>
    </div>
</div>
<div id="errordialog" class="modal" style="position: fixed; top: auto; left: auto; z-index: 101; display: none">
    <div class="modal-header">
        <h3>Error occurred</h3>
    </div>
    <div class="modal-body">
        <p>Please try again</p>
    </div>
    <div class="modal-footer">
        <a class="btn_ok btn primary">OK</a>
    </div>
</div>